{
    "contents" : "wam     <- data.frame(expand.grid(a=c(\"attended\", \"Notattended\"), b=c(\"Female\", \"male\"), c = c(\"Suburban\", \"urban\"), d = c(\"Agree\", \"Disagree\"), e = c(\"Maths\", \"Arts\"),f = c(\"college\", \"job\")),count=c(37, 27, 51, 48, 51, 55, 109, 86, 16, 11, 10, 19, 24, 28, 21, 25,\n                                                                                                                                                                                                         16, 15,  7,  6, 32, 34, 30, 31,\n                                                                                                                                                                                                         12, 24, 13,  7, 55, 39, 26, 19,\n                                                                                                                                                                                                         10,  8, 12, 15, 2, 1, 9, 5,\n                                                                                                                                                                                                         9, 4, 8, 9, 8, 9, 4, 5,\n                                                                                                                                                                                                         7, 10, 7, 3, 5, 2, 1, 3,\n                                                                                                                                                                                                         8, 4, 6, 4, 10, 9, 3, 6 ))\n\nwm=xtabs(count~a+b+c+d+e+f,wam)\nsave(wm, file=\"wam\")\nload(\"wam\")\n\nmciTest_table(wm,c(\"a\",\"b\",\"c\",\"d\",\"e\",\"f\"))# does not fit, G=288.2007,DF=57\ndm = loglm(count~a+b+c+d+e+f+a*b , data= wam) #NO, 288.1934 56 ,diff from ST =  0.0066, 0.9352508\ndm = loglm(count~a+b+c+d+e+f+a*c , data= wam) #288.1711 56 , 0.029 0.8650101,\ndm = loglm(count~a+b+c+d+e+f+a*d , data= wam) # 288.0081 56  0.1919, 0.661339\ndm = loglm(count~a+b+c+d+e+f+a*e , data= wam) # 288.1522 56  0.0478  0.8269\ndm = loglm(count~a+b+c+d+e+f+a*f , data= wam) # 288.1206 56  0.0794  0.7781122\n\ndm = loglm(count~a+b+c+d+e+f+b*c , data= wam) # 288.1749 56   0.0251 0.8741181\ndm = loglm(count~a+b+c+d+e+f+b*d , data= wam) # 255.9685 56   32.2315 0\ndm = loglm(count~a+b+c+d+e+f+b*e , data= wam) # 236.5743 56   51.6257 0\ndm = loglm(count~a+b+c+d+e+f+b*f , data= wam) #  287.5532 56   0.6468 0.421\n\nloglm(count~a+b+c+d+e+f+c*d , data= wam) #287.7588 56  0.4412 0.506\nloglm(count~a+b+c+d+e+f+c*d , data= wam) #282.0525 56   6.1475 0.013\nloglm(count~a+b+c+d+e+f+c*d , data= wam) #233.8028 56   54.3972 0\n\nloglm(count~a+b+c+d+e+f+d*e , data= wam) # 211.6633 56  76.5367 0\nloglm(count~a+b+c+d+e+f+d*f , data= wam) #270.1923 56  18.0077  0\n\nloglm(count~a+b+c+d+e+f+e*f , data= wam) #286.0219 56  2.1781   0.1399872\n\n#{a,b,c,d,f} {a,b,c,e,f} #de addes\nmciTest_table(wm,c(\"a\",\"b\",\"c\",\"d\",\"f\")) #does not, 151.6613 , DF = 52\n\nloglm(count~a+b+c+d+e+f+d*e+a*b , data= wam) #211.656 55, diff = 0.0073, 0.9319116\nloglm(count~a+b+c+d+e+f+d*e+a*c , data= wam)# 211.6337 55 \nloglm(count~a+b+c+d+e+f+d*e+a*d , data= wam)# 211.4706 5\nloglm(count~a+b+c+d+e+f+d*e+a*f , data= wam)# 211.5832 55\nloglm(count~a+b+c+d+e+f+d*e+b*c , data= wam) # 211.6375 55\nloglm(count~a+b+c+d+e+f+d*e+b*d , data= wam) #179.4310 55 , 32.2323 , 0\nloglm(count~a+b+c+d+e+f+d*e+b*f , data= wam) #211.0158 55 \nloglm(count~a+b+c+d+e+f+d*e+c*d , data= wam)# 211.2214 55 \nloglm(count~a+b+c+d+e+f+d*e+c*f , data= wam) #157.2653 55\nloglm(count~a+b+c+d+e+f+d*e+d*f , data= wam) #193.6548 55\n\n#{a,b,c,d},{a,b,d,f} {a,b,c,e},{a,b,e,f} #cf added\nmciTest_table(wm,c(\"a\",\"b\",\"c\",\"f\")) # NO,  107.3883, 0, 44\nloglm(count~a+b+c+d+e+f+d*e+c*f+a*b, data= wam) #157.2580  54\nloglm(count~a+b+c+d+e+f+d*e+c*f+a*c, data= wam) #157.2357 54\nloglm(count~a+b+c+d+e+f+d*e+c*f+a*d, data= wam) # 157.0727 54\nloglm(count~a+b+c+d+e+f+d*e+c*f+b*c, data= wam) #157.2395 54\nloglm(count~a+b+c+d+e+f+d*e+c*f+b*d, data= wam) #125.0331 54\nloglm(count~a+b+c+d+e+f+d*e+c*f+c*d, data= wam) # 156.8235 54 , diff= 86.1883 , 0\n\n#{a,b,c},{a,c,d},{a,b,f},{a,d,f}, {a,b,c,e},{a,b,e,f} #bd added\nmciTest_table(wm,c(\"a\",\"b\",\"c\"),\"REST\") #G=37.73403,p=0.2235651,DF=32\n\n#,{a,c,d},{a,b,f},{a,d,f}, {a,b,c,e},{a,b,e,f} #{a,b,c} removed\nmciTest_table(wm,c(\"a\",\"c\",\"d\"),\"REST\")#NO,48.87303,0.02853602\nloglm(count~a+b+c+d+e+f+d*e+c*f+b*d+a*c, data= wam) # 125.0034 53\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+a*d, data= wam) #124.8404 53\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d, data= wam) #124.5912 53\n\n\n#{a,c},{a,d},{a,b,f},{a,d,f}, {a,b,c,e},{a,b,e,f}  # cd added\nmciTest_table(wm,c(\"a\",\"c\"),\"REST\")# 20.68855,0.1907954, 16\nmciTest_table(wm,c(\"a\",\"d\"),\"REST\")# 14.17235, 0.5858755, 16\n\n#{a,b,f},{a,d,f}, {a,b,c,e},{a,b,e,f}  #{a,c},{a,d} removed\nmciTest_table(wm,c(\"a\",\"b\",\"f\"),\"REST\") #29.95169,  0.5705642, 32\n\n#{a,d,f}, {a,b,c,e},{a,b,e,f} #{a,b,f} removed\nmciTest_table(wm,c(\"a\",\"d\",\"f\"),\"REST\") #55.57727,  0.006024272, 32\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+a*d, data= wam) # 124.3985 52\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+a*f, data= wam) #124.5111 52 \nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f, data= wam) #104.2888 52, 20.3024, 0, \n\n#{a,d},{a,f} {a,b,c,e},{a,b,e,f} #df added\nmciTest_table(wm,c(\"a\",\"d\"),\"REST\") #14.17235, 0.5858755, 16\nmciTest_table(wm,c(\"a\",\"f\"),\"REST\") # 11.9511,0.7473394 ,16\n\n# {a,b,c,e},{a,b,e,f} #{a,d},{a,f} removed\nmciTest_table(wm,c(\"a\",\"b\",\"c\",\"e\")) #NO, 69.23894, 0 , DF 11\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f, data= wam)\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f, data= wam)\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f, data= wam)\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e, data= wam) #98.58101 51\n\n#ce dded, {a,b,e,f}\nmciTest_table(wm,c(\"a\",\"b\",\"e\",\"f\")) #55.60231, 0 DF 11\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+a*b, data= wam) \nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+a*e, data= wam) \nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+a*f, data= wam) \nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+b*e, data= wam) #62.73764 50 , 0.10662021\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+b*f, data= wam) \nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+e*f, data= wam) \n\n#be dded, {a,e,f},\nmciTest_table(wm,c(\"a\",\"e\",\"f\")) # 40.11591,  0.1535415, 32\n\n#Final model, fits the data\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+c*d+d*f+c*e+b*e, data= wam) #62.73764 50 , 0.10662021 \n#this also fits the model\nloglm(count~a+b+c+d+e+f+d*e+b*d+c*f+d*f+c*e+b*e, data= wam)\n##Likelihood Ratio 63.76725 51 0.10811750\n\n#output:  \n#[1] \"a\"   \"b\"   \"c\"   \"d\"   \"e\"   \"f\"   \"d*e\" \"c*f\" \"b*d\" \"c*d\" \"d*f\" \"b*e\"\n#[1] \"a\"   \"b\"   \"c\"   \"d\"   \"e\"   \"f\"   \"d*e\" \"c*f\" \"b*d\" \"c*d\" \"d*f\"\n\nu1= ~a + b + c + d + e + f + d * e + c * f + b *\n  d + d * f + b * e + c * d\nu1 = ug(u1)\nas.adjMAT(u1)\n#\nmat = as.adjMAT(u1)\nmc = maxCliqueMAT(mat)\nll= loglin(wm,mc$maxCliques)\n\nlgfit= loglin(wm,mc$maxCliques,fit=TRUE,\n           print=FALSE)\n\niii <- wm* lgfit$fit > 0\n\nlgfit$logL      <- sum(wm[iii] * log(lgfit$fit[iii]/sum(lgfit$fit)))\n\n\nlgfit$aic       <- -2*lgfit$logL + 2*lgfit$df\nlgfit$bic       <- -2*llfit$logL + log(sum(wm))*lgfit$df\n\nSat model\nModel: A dModel with 6 variables\ngraphical :  TRUE  decomposable :  TRUE\n-2logL    :        8841.91 mdim :   63 aic :      8967.91 \nideviance :         288.20 idf  :   57 bic :      9288.06 \ndeviance  :           0.00 df   :    0 \n\n\nd1 = dmod(~a+b+c+d+e+f,wm)\n> d1\nModel: A dModel with 6 variables\ngraphical :  TRUE  decomposable :  TRUE\n-2logL    :        9130.11 mdim :    6 aic :      9142.11 \nideviance :          -0.00 idf  :    0 bic :      9172.60 \ndeviance  :         288.20 df   :   57 \n\nmci.aic(wm,c(\"a\",\"b\",\"c\",\"d\",\"e\",\"f\"))\n[1] 9256.109",
    "created" : 1433602064485.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3915372338",
    "id" : "9F7C5E15",
    "lastKnownWriteTime" : 1433689583,
    "path" : "E:/RPrograms/MutualCondIndep/mciTestWAM.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}